#!/usr/bin/env python
"""Verify all kernel bytecode arrays against OSE source values."""

def compare(name, src_dec, our_hex):
    """Compare OSE decimal array to our hex array."""
    if len(src_dec) != len(our_hex):
        print(f"  {name}: LENGTH MISMATCH src={len(src_dec)} ours={len(our_hex)}")
    diffs = [(i, src_dec[i], our_hex[i]) for i in range(min(len(src_dec), len(our_hex))) if src_dec[i] != our_hex[i]]
    if diffs:
        print(f"  {name}: {len(diffs)} DIFFS!")
        for idx, s, o in diffs[:20]:
            print(f"    byte[{idx}]: src={s} (0x{s:02X}), ours={o} (0x{o:02X})")
    else:
        print(f"  {name}: OK ({len(src_dec)} bytes match)")

# ── EXEC BLOCK 0 (171 bytes) ──
src0 = [247, 254, 6, 1, 50, 134, 170, 54, 24, 48, 134, 6, 198, 1, 189, 255, 189, 50, 57, 204, 2, 65, 151, 52, 157, 36, 32, 153, 54, 24, 60, 60, 24, 56, 206, 16, 0, 134, 8, 167, 45, 79, 151, 48, 134, 247, 141, 38, 23, 139, 85, 141, 33, 150, 52, 141, 29, 90, 39, 10, 24, 166, 0, 141, 21, 24, 8, 90, 38, 246, 150, 48, 64, 141, 11, 31, 46, 64, 252, 29, 45, 8, 24, 56, 50, 57, 157, 30, 31, 46, 128, 250, 167, 47, 155, 48, 151, 48, 57, 55, 198, 85, 247, 16, 58, 83, 247, 16, 58, 198, 80, 247, 24, 6, 198, 160, 247, 24, 6, 51, 57, 220, 53, 77, 38, 4, 198, 72, 32, 13, 193, 128, 36, 7, 20, 54, 128, 198, 88, 32, 2, 198, 80, 247, 16, 0, 57, 60, 206, 16, 0, 28, 3, 8, 29, 2, 8, 56, 57, 60, 206, 16, 0, 28, 3, 8, 28, 2, 8, 56, 57]
our0 = [0xF7, 0xFE, 0x06, 0x01, 0x32, 0x86, 0xAA, 0x36, 0x18, 0x30, 0x86, 0x06, 0xC6, 0x01, 0xBD, 0xFF, 0xBD, 0x32, 0x39, 0xCC, 0x02, 0x41, 0x97, 0x34, 0x9D, 0x24, 0x20, 0x99, 0x36, 0x18, 0x3C, 0x3C, 0x18, 0x38, 0xCE, 0x10, 0x00, 0x86, 0x08, 0xA7, 0x2D, 0x4F, 0x97, 0x30, 0x86, 0xF7, 0x8D, 0x26, 0x17, 0x8B, 0x55, 0x8D, 0x21, 0x96, 0x34, 0x8D, 0x1D, 0x5A, 0x27, 0x0A, 0x18, 0xA6, 0x00, 0x8D, 0x15, 0x18, 0x08, 0x5A, 0x26, 0xF6, 0x96, 0x30, 0x40, 0x8D, 0x0B, 0x1F, 0x2E, 0x40, 0xFC, 0x1D, 0x2D, 0x08, 0x18, 0x38, 0x32, 0x39, 0x9D, 0x1E, 0x1F, 0x2E, 0x80, 0xFA, 0xA7, 0x2F, 0x9B, 0x30, 0x97, 0x30, 0x39, 0x37, 0xC6, 0x55, 0xF7, 0x10, 0x3A, 0x53, 0xF7, 0x10, 0x3A, 0xC6, 0x50, 0xF7, 0x18, 0x06, 0xC6, 0xA0, 0xF7, 0x18, 0x06, 0x33, 0x39, 0xDC, 0x35, 0x4D, 0x26, 0x04, 0xC6, 0x48, 0x20, 0x0D, 0xC1, 0x80, 0x24, 0x07, 0x14, 0x36, 0x80, 0xC6, 0x58, 0x20, 0x02, 0xC6, 0x50, 0xF7, 0x10, 0x00, 0x39, 0x3C, 0xCE, 0x10, 0x00, 0x1C, 0x03, 0x08, 0x1D, 0x02, 0x08, 0x38, 0x39, 0x3C, 0xCE, 0x10, 0x00, 0x1C, 0x03, 0x08, 0x1C, 0x02, 0x08, 0x38, 0x39]
compare("EXEC_BLOCK_0", src0, our0)

# ── EXEC BLOCK 1 (172 bytes) ──
src1 = [247, 255, 6, 0, 153, 134, 170, 54, 24, 48, 134, 6, 198, 1, 189, 255, 189, 50, 57, 50, 141, 63, 151, 55, 122, 0, 50, 206, 3, 0, 32, 16, 141, 51, 151, 46, 122, 0, 50, 141, 44, 151, 47, 122, 0, 50, 222, 46, 140, 3, 255, 34, 165, 141, 30, 167, 0, 8, 122, 0, 50, 38, 241, 141, 20, 93, 38, 150, 150, 51, 129, 16, 39, 6, 222, 46, 173, 0, 32, 138, 189, 2, 24, 32, 249, 60, 206, 16, 0, 24, 206, 5, 117, 127, 0, 49, 122, 0, 49, 38, 4, 24, 9, 39, 6, 157, 30, 31, 46, 14, 2, 32, 221, 31, 46, 32, 235, 166, 47, 22, 219, 48, 215, 48, 56, 57, 129, 2, 38, 204, 141, 209, 151, 53, 141, 205, 151, 54, 141, 201, 151, 55, 141, 197, 93, 38, 187, 206, 3, 32, 141, 122, 24, 222, 54, 95, 24, 166, 0, 167, 0, 8, 24, 8, 92, 193, 64, 37, 243, 206, 3, 32]
our1 = [0xF7, 0xFF, 0x06, 0x00, 0x99, 0x86, 0xAA, 0x36, 0x18, 0x30, 0x86, 0x06, 0xC6, 0x01, 0xBD, 0xFF, 0xBD, 0x32, 0x39, 0x32, 0x8D, 0x3F, 0x97, 0x37, 0x7A, 0x00, 0x32, 0xCE, 0x03, 0x00, 0x20, 0x10, 0x8D, 0x33, 0x97, 0x2E, 0x7A, 0x00, 0x32, 0x8D, 0x2C, 0x97, 0x2F, 0x7A, 0x00, 0x32, 0xDE, 0x2E, 0x8C, 0x03, 0xFF, 0x22, 0xA5, 0x8D, 0x1E, 0xA7, 0x00, 0x08, 0x7A, 0x00, 0x32, 0x26, 0xF1, 0x8D, 0x14, 0x5D, 0x26, 0x96, 0x96, 0x33, 0x81, 0x10, 0x27, 0x06, 0xDE, 0x2E, 0xAD, 0x00, 0x20, 0x8A, 0xBD, 0x02, 0x18, 0x20, 0xF9, 0x3C, 0xCE, 0x10, 0x00, 0x18, 0xCE, 0x05, 0x75, 0x7F, 0x00, 0x31, 0x7A, 0x00, 0x31, 0x26, 0x04, 0x18, 0x09, 0x27, 0x06, 0x9D, 0x1E, 0x1F, 0x2E, 0x0E, 0x02, 0x20, 0xDD, 0x1F, 0x2E, 0x20, 0xEB, 0xA6, 0x2F, 0x16, 0xDB, 0x30, 0xD7, 0x30, 0x38, 0x39, 0x81, 0x02, 0x26, 0xCC, 0x8D, 0xD1, 0x97, 0x35, 0x8D, 0xCD, 0x97, 0x36, 0x8D, 0xC9, 0x97, 0x37, 0x8D, 0xC5, 0x5D, 0x26, 0xBB, 0xCE, 0x03, 0x20, 0x8D, 0x7A, 0x18, 0xDE, 0x36, 0x5F, 0x18, 0xA6, 0x00, 0xA7, 0x00, 0x08, 0x18, 0x08, 0x5C, 0xC1, 0x40, 0x25, 0xF3, 0xCE, 0x03, 0x20]
compare("EXEC_BLOCK_1", src1, our1)

# ── EXEC BLOCK 2 (156 bytes) ──
src2 = [247, 239, 6, 0, 16, 32, 62, 0, 0, 0, 0, 0, 0, 0, 0, 0, 126, 1, 204, 126, 1, 144, 0, 0, 0, 126, 1, 73, 126, 1, 192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 142, 0, 79, 15, 182, 24, 5, 138, 8, 183, 24, 5, 157, 39, 60, 48, 134, 6, 151, 52, 204, 170, 0, 237, 0, 198, 2, 157, 36, 56, 142, 0, 79, 206, 16, 0, 134, 4, 167, 45, 236, 46, 79, 151, 48, 28, 45, 2, 141, 103, 129, 247, 38, 232, 141, 97, 128, 86, 37, 226, 151, 50, 141, 89, 151, 51, 129, 6, 39, 30, 129, 16, 38, 120, 141, 77, 151, 53, 122, 0, 50, 141, 70, 151, 54, 122, 0]
our2 = [0xF7, 0xEF, 0x06, 0x00, 0x10, 0x20, 0x3E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7E, 0x01, 0xCC, 0x7E, 0x01, 0x90, 0x00, 0x00, 0x00, 0x7E, 0x01, 0x49, 0x7E, 0x01, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x8E, 0x00, 0x4F, 0x0F, 0xB6, 0x18, 0x05, 0x8A, 0x08, 0xB7, 0x18, 0x05, 0x9D, 0x27, 0x3C, 0x30, 0x86, 0x06, 0x97, 0x34, 0xCC, 0xAA, 0x00, 0xED, 0x00, 0xC6, 0x02, 0x9D, 0x24, 0x38, 0x8E, 0x00, 0x4F, 0xCE, 0x10, 0x00, 0x86, 0x04, 0xA7, 0x2D, 0xEC, 0x2E, 0x4F, 0x97, 0x30, 0x1C, 0x2D, 0x02, 0x8D, 0x67, 0x81, 0xF7, 0x26, 0xE8, 0x8D, 0x61, 0x80, 0x56, 0x25, 0xE2, 0x97, 0x32, 0x8D, 0x59, 0x97, 0x33, 0x81, 0x06, 0x27, 0x1E, 0x81, 0x10, 0x26, 0x78, 0x8D, 0x4D, 0x97, 0x35, 0x7A, 0x00, 0x32, 0x8D, 0x46, 0x97, 0x36, 0x7A, 0x00]
compare("EXEC_BLOCK_2", src2, our2)

# ── FLASH INFO (139 bytes) ──
src_fi = [247, 222, 6, 2, 0, 198, 72, 247, 16, 0, 157, 27, 134, 170, 183, 85, 85, 134, 85, 183, 42, 170, 134, 144, 183, 85, 85, 157, 39, 206, 3, 32, 182, 32, 0, 167, 0, 8, 182, 32, 1, 167, 0, 8, 24, 206, 32, 2, 141, 82, 24, 206, 64, 2, 141, 76, 24, 206, 128, 2, 141, 70, 24, 206, 192, 2, 141, 64, 198, 88, 247, 16, 0, 24, 206, 128, 2, 141, 53, 24, 206, 192, 2, 141, 47, 198, 80, 247, 16, 0, 24, 206, 128, 2, 141, 36, 24, 206, 192, 2, 141, 30, 157, 27, 198, 170, 247, 85, 85, 198, 85, 247, 42, 170, 198, 240, 247, 85, 85, 157, 39, 206, 3, 32, 204, 6, 11, 151, 52, 157, 36, 57, 24, 166, 0, 167, 0, 8, 57]
our_fi = [0xF7, 0xDE, 0x06, 0x02, 0x00, 0xC6, 0x48, 0xF7, 0x10, 0x00, 0x9D, 0x1B, 0x86, 0xAA, 0xB7, 0x55, 0x55, 0x86, 0x55, 0xB7, 0x2A, 0xAA, 0x86, 0x90, 0xB7, 0x55, 0x55, 0x9D, 0x27, 0xCE, 0x03, 0x20, 0xB6, 0x20, 0x00, 0xA7, 0x00, 0x08, 0xB6, 0x20, 0x01, 0xA7, 0x00, 0x08, 0x18, 0xCE, 0x20, 0x02, 0x8D, 0x52, 0x18, 0xCE, 0x40, 0x02, 0x8D, 0x4C, 0x18, 0xCE, 0x80, 0x02, 0x8D, 0x46, 0x18, 0xCE, 0xC0, 0x02, 0x8D, 0x40, 0xC6, 0x58, 0xF7, 0x10, 0x00, 0x18, 0xCE, 0x80, 0x02, 0x8D, 0x35, 0x18, 0xCE, 0xC0, 0x02, 0x8D, 0x2F, 0xC6, 0x50, 0xF7, 0x10, 0x00, 0x18, 0xCE, 0x80, 0x02, 0x8D, 0x24, 0x18, 0xCE, 0xC0, 0x02, 0x8D, 0x1E, 0x9D, 0x1B, 0xC6, 0xAA, 0xF7, 0x55, 0x55, 0xC6, 0x55, 0xF7, 0x2A, 0xAA, 0xC6, 0xF0, 0xF7, 0x55, 0x55, 0x9D, 0x27, 0xCE, 0x03, 0x20, 0xCC, 0x06, 0x0B, 0x97, 0x34, 0x9D, 0x24, 0x39, 0x18, 0xA6, 0x00, 0xA7, 0x00, 0x08, 0x39]
compare("FLASH_INFO", src_fi, our_fi)

# ── ERASE SECTOR (108 bytes) ──
src_er = [247, 191, 6, 2, 0, 246, 2, 100, 247, 16, 0, 157, 27, 134, 170, 183, 85, 85, 134, 85, 183, 42, 170, 134, 128, 183, 85, 85, 134, 170, 183, 85, 85, 134, 85, 183, 42, 170, 134, 48, 254, 2, 101, 167, 0, 157, 39, 157, 30, 254, 2, 101, 166, 0, 43, 32, 133, 32, 39, 243, 157, 27, 198, 170, 247, 85, 85, 198, 85, 247, 42, 170, 198, 240, 247, 85, 85, 157, 39, 134, 6, 151, 52, 204, 85, 0, 32, 7, 134, 6, 151, 52, 204, 170, 0, 60, 48, 237, 0, 198, 2, 157, 36, 56, 57, 72, 64, 0]
our_er = [0xF7, 0xBF, 0x06, 0x02, 0x00, 0xF6, 0x02, 0x64, 0xF7, 0x10, 0x00, 0x9D, 0x1B, 0x86, 0xAA, 0xB7, 0x55, 0x55, 0x86, 0x55, 0xB7, 0x2A, 0xAA, 0x86, 0x80, 0xB7, 0x55, 0x55, 0x86, 0xAA, 0xB7, 0x55, 0x55, 0x86, 0x55, 0xB7, 0x2A, 0xAA, 0x86, 0x30, 0xFE, 0x02, 0x65, 0xA7, 0x00, 0x9D, 0x27, 0x9D, 0x1E, 0xFE, 0x02, 0x65, 0xA6, 0x00, 0x2B, 0x20, 0x85, 0x20, 0x27, 0xF3, 0x9D, 0x1B, 0xC6, 0xAA, 0xF7, 0x55, 0x55, 0xC6, 0x55, 0xF7, 0x2A, 0xAA, 0xC6, 0xF0, 0xF7, 0x55, 0x55, 0x9D, 0x27, 0x86, 0x06, 0x97, 0x34, 0xCC, 0x55, 0x00, 0x20, 0x07, 0x86, 0x06, 0x97, 0x34, 0xCC, 0xAA, 0x00, 0x3C, 0x30, 0xED, 0x00, 0xC6, 0x02, 0x9D, 0x24, 0x38, 0x39, 0x48, 0x40, 0x00]
compare("ERASE_SECTOR", src_er, our_er)

# ── WRITE BANK (158 bytes) ──
src_wb = [247, 241, 6, 2, 0, 60, 48, 134, 6, 151, 52, 204, 170, 0, 237, 0, 198, 2, 157, 36, 56, 57, 0, 0, 0, 0, 0, 0, 0, 206, 3, 0, 134, 32, 183, 3, 97, 24, 254, 0, 54, 79, 246, 2, 152, 247, 16, 0, 157, 27, 198, 170, 247, 85, 85, 198, 85, 247, 42, 170, 198, 160, 247, 85, 85, 230, 0, 24, 231, 0, 157, 30, 157, 39, 230, 0, 55, 24, 232, 0, 51, 43, 14, 24, 230, 0, 225, 0, 39, 45, 76, 129, 10, 35, 203, 32, 25, 197, 32, 39, 229, 60, 157, 27, 198, 170, 247, 85, 85, 198, 85, 247, 42, 170, 198, 240, 247, 85, 85, 157, 39, 56, 134, 16, 151, 52, 204, 85, 0, 237, 0, 198, 2, 32, 19, 8, 24, 8, 122, 3, 97, 38, 154, 134, 16, 151, 52, 204, 170, 0, 237, 0, 198, 2, 157, 36, 57, 72]
our_wb = [0xF7, 0xF1, 0x06, 0x02, 0x00, 0x3C, 0x30, 0x86, 0x06, 0x97, 0x34, 0xCC, 0xAA, 0x00, 0xED, 0x00, 0xC6, 0x02, 0x9D, 0x24, 0x38, 0x39, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xCE, 0x03, 0x00, 0x86, 0x20, 0xB7, 0x03, 0x61, 0x18, 0xFE, 0x00, 0x36, 0x4F, 0xF6, 0x02, 0x98, 0xF7, 0x10, 0x00, 0x9D, 0x1B, 0xC6, 0xAA, 0xF7, 0x55, 0x55, 0xC6, 0x55, 0xF7, 0x2A, 0xAA, 0xC6, 0xA0, 0xF7, 0x55, 0x55, 0xE6, 0x00, 0x18, 0xE7, 0x00, 0x9D, 0x1E, 0x9D, 0x27, 0xE6, 0x00, 0x37, 0x18, 0xE8, 0x00, 0x33, 0x2B, 0x0E, 0x18, 0xE6, 0x00, 0xE1, 0x00, 0x27, 0x2D, 0x4C, 0x81, 0x0A, 0x23, 0xCB, 0x20, 0x19, 0xC5, 0x20, 0x27, 0xE5, 0x3C, 0x9D, 0x1B, 0xC6, 0xAA, 0xF7, 0x55, 0x55, 0xC6, 0x55, 0xF7, 0x2A, 0xAA, 0xC6, 0xF0, 0xF7, 0x55, 0x55, 0x9D, 0x27, 0x38, 0x86, 0x10, 0x97, 0x34, 0xCC, 0x55, 0x00, 0xED, 0x00, 0xC6, 0x02, 0x20, 0x13, 0x08, 0x18, 0x08, 0x7A, 0x03, 0x61, 0x26, 0x9A, 0x86, 0x10, 0x97, 0x34, 0xCC, 0xAA, 0x00, 0xED, 0x00, 0xC6, 0x02, 0x9D, 0x24, 0x39, 0x48]
compare("WRITE_BANK", src_wb, our_wb)

# ── CHECKSUM BIN (138 bytes) ──
src_cs = [247, 225, 6, 2, 0, 134, 1, 183, 3, 99, 24, 206, 3, 232, 206, 32, 0, 204, 0, 0, 55, 246, 3, 99, 193, 4, 51, 44, 59, 54, 55, 182, 3, 99, 129, 1, 38, 7, 198, 72, 247, 16, 0, 32, 16, 129, 2, 38, 7, 198, 88, 247, 16, 0, 32, 5, 198, 80, 247, 16, 0, 51, 50, 235, 0, 137, 0, 8, 38, 6, 124, 3, 99, 206, 128, 0, 24, 9, 38, 6, 157, 30, 24, 206, 3, 232, 32, 188, 60, 206, 64, 0, 224, 0, 130, 0, 8, 140, 64, 8, 37, 246, 55, 54, 253, 3, 100, 177, 64, 6, 38, 9, 241, 64, 7, 38, 4, 134, 170, 32, 2, 134, 85, 54, 134, 6, 151, 52, 48, 198, 4, 157, 36, 50, 50, 51, 56, 57]
our_cs = [0xF7, 0xE1, 0x06, 0x02, 0x00, 0x86, 0x01, 0xB7, 0x03, 0x63, 0x18, 0xCE, 0x03, 0xE8, 0xCE, 0x20, 0x00, 0xCC, 0x00, 0x00, 0x37, 0xF6, 0x03, 0x63, 0xC1, 0x04, 0x33, 0x2C, 0x3B, 0x36, 0x37, 0xB6, 0x03, 0x63, 0x81, 0x01, 0x26, 0x07, 0xC6, 0x48, 0xF7, 0x10, 0x00, 0x20, 0x10, 0x81, 0x02, 0x26, 0x07, 0xC6, 0x58, 0xF7, 0x10, 0x00, 0x20, 0x05, 0xC6, 0x50, 0xF7, 0x10, 0x00, 0x33, 0x32, 0xEB, 0x00, 0x89, 0x00, 0x08, 0x26, 0x06, 0x7C, 0x03, 0x63, 0xCE, 0x80, 0x00, 0x18, 0x09, 0x26, 0x06, 0x9D, 0x1E, 0x18, 0xCE, 0x03, 0xE8, 0x20, 0xBC, 0x3C, 0xCE, 0x40, 0x00, 0xE0, 0x00, 0x82, 0x00, 0x08, 0x8C, 0x40, 0x08, 0x25, 0xF6, 0x37, 0x36, 0xFD, 0x03, 0x64, 0xB1, 0x40, 0x06, 0x26, 0x09, 0xF1, 0x40, 0x07, 0x26, 0x04, 0x86, 0xAA, 0x20, 0x02, 0x86, 0x55, 0x36, 0x86, 0x06, 0x97, 0x34, 0x30, 0xC6, 0x04, 0x9D, 0x24, 0x32, 0x32, 0x33, 0x38, 0x39]
compare("CHECKSUM_BIN", src_cs, our_cs)

# ── CLEANUP (33 bytes) ──
src_cl = [247, 116, 6, 2, 0, 60, 48, 134, 6, 151, 52, 204, 187, 0, 237, 0, 198, 2, 157, 36, 56, 206, 1, 255, 111, 0, 9, 38, 251, 111, 0, 32, 254]
our_cl = [0xF7, 0x74, 0x06, 0x02, 0x00, 0x3C, 0x30, 0x86, 0x06, 0x97, 0x34, 0xCC, 0xBB, 0x00, 0xED, 0x00, 0xC6, 0x02, 0x9D, 0x24, 0x38, 0xCE, 0x01, 0xFF, 0x6F, 0x00, 0x09, 0x26, 0xFB, 0x6F, 0x00, 0x20, 0xFE]
compare("CLEANUP", src_cl, our_cl)

print("\n=== ALL KERNEL BYTECODES VERIFIED ===")
